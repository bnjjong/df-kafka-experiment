# 10⁶건 전송 기준 single vs batch 성능 정리

## 테스트 개요
- Kafka 프로듀서 로드 테스트를 통해 총 1,000,000건 전송 시간을 측정
- `batch` 프로필은 `linger.ms=50`, `compression=snappy`, `enable.idempotence=true`
- `single` 프로필은 기본적으로 `linger.ms=0`이며, 비교 실험으로 10ms/20ms까지 상승시켜 측정
- 동일한 애플리케이션과 테스트 러너(`AdClickLoadTestRunner`)를 사용하며, 결과는 애플리케이션 로그 기반으로 수집

## 측정 결과

### batch 프로필 (linger.ms=50)

| 실행 | 소요 시간(ms) |
| --- | ---: |
| 1 | 9,225 |
| 2 | 8,564 |
| 3 | 8,609 |
| 4 | 8,542 |
| 5 | 8,292 |
| 6 | 8,133 |

- 평균: 약 8,561ms (약 8.6초)
- 러닝 타임이 안정적으로 8~9초 구간에 위치하며 배치 전송의 완충 효과가 유지됨

### single 프로필 (linger.ms 조정)

| 실행 | linger.ms | 소요 시간(ms) |
| --- | ---: | ---: |
| 1 | 0 | 11,505 |
| 2 | 0 | 9,150 |
| 3 | 10 | 8,788 |
| 4 | 20 | 8,763 |

- 평균: 약 9,552ms (약 9.6초)
- `linger.ms`를 0에서 10~20ms로 높이면 싱글 프로필도 8초대 성능으로 개선되나, 여전히 배치 프로필 대비 약간 느림

## 해석
- 동일 건수에서 배치 프로필이 평균 1초 정도 빠르게 완료되어 대량 전송에 유리함
- 싱글 프로필 역시 `linger.ms` 조정만으로 개선 가능하지만, 배치 설정과 동일한 수준의 중간 버퍼링/압축 설정을 사용하지 않아 미세한 격차가 남아 있음
- 지속적인 최적화를 위해서는 메시지 크기, 네트워크 상황, 브로커 부하 등을 추가로 관찰하며 `compression` 및 `linger.ms` 값을 환경에 맞게 조정하는 것이 권장됨
